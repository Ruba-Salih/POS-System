{% extends "base.html" %}
{% load static %}

{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/ticket-detail.css' %}">
{% endblock %}

{% block content %}

<div class="ticket-detail-page">

    <!-- HEADER -->
    <div class="ticket-header">
        <h2>ğŸ§¾ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø±Ù‚Ù… {{ ticket.id }}</h2>
        <div class="ticket-total">
            ğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <strong>{{ ticket.total_amount }}</strong>
        </div>
    </div>

    <!-- INFO CARDS -->
    <div class="ticket-info-grid">

        <div class="info-card">
            <span class="info-label">ğŸ‘¤ Ø§Ù„ÙƒØ§Ø´ÙŠØ±</span>
            <span class="info-value">
                {{ ticket.cashier.full_name|default:ticket.cashier.username }}
            </span>
        </div>

        <div class="info-card">
            <span class="info-label">ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</span>
            <span class="info-value">
                {% if ticket.payment_method == 'cash' %}
                    Ù†Ù‚Ø¯Ø§Ù‹
                {% elif ticket.payment_method == 'transfer' %}
                    ØªØ­ÙˆÙŠÙ„
                    {% if ticket.transfer_number %}
                        <small class="muted">
                            Ø±Ù‚Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„: {{ ticket.transfer_number }}
                        </small>
                    {% endif %}
                {% else %}
                    ØºÙŠØ± Ù…Ø­Ø¯Ø¯
                {% endif %}
            </span>
        </div>

        <div class="info-card">
            <span class="info-label">ğŸ“Œ Ø§Ù„Ø­Ø§Ù„Ø©</span>
            <span class="info-value">
                {% if ticket.status == 'closed' %}
                    <span class="badge badge-success">Ù…ØºÙ„Ù‚</span>
                {% elif ticket.status == 'refunded' %}
                    <span class="badge badge-danger">Ù…ÙØ±Ø¬Ø¹</span>
                {% else %}
                    <span class="badge badge-secondary">{{ ticket.status }}</span>
                {% endif %}
            </span>
        </div>

        <div class="info-card">
            <span class="info-label">ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®</span>
            <span class="info-value">
                {{ ticket.created_at }}
            </span>
        </div>

    </div>

    <!-- PRODUCTS -->
    <div class="products-section">
        <h4>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h4>

        <div class="table-wrapper">
            <table class="products-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                        <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                        <th>Ø§Ù„Ø³Ø¹Ø±</th>
                        <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                    </tr>
                </thead>

                <tbody>
                {% for item in items %}
                    <tr>
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.price }}</td>
                        <td>{{ item.price|floatformat:2 }}</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="4" class="empty-row">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</div>

{% endblock %}
